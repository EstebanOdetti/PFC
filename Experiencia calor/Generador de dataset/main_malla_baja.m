close all; clear all; more off;

xnode = [
  0.0000000000000000, 0.0000000000000000;
  0.0000000000000000, 0.1666666666666667;
  0.0000000000000000, 0.3333333333333333;
  0.0000000000000000, 0.5000000000000000;
  0.0000000000000000, 0.6666666666666666;
  0.0000000000000000, 0.8333333333333333;
  0.0000000000000000, 1.0000000000000000;
  0.1666666666666667, 0.0000000000000000;
  0.1666666666666667, 0.1666666666666667;
  0.1666666666666667, 0.3333333333333333;
  0.1666666666666667, 0.5000000000000000;
  0.1666666666666667, 0.6666666666666666;
  0.1666666666666667, 0.8333333333333333;
  0.1666666666666667, 1.0000000000000000;
  0.3333333333333333, 0.0000000000000000;
  0.3333333333333333, 0.1666666666666667;
  0.3333333333333333, 0.3333333333333333;
  0.3333333333333333, 0.5000000000000000;
  0.3333333333333333, 0.6666666666666666;
  0.3333333333333333, 0.8333333333333333;
  0.3333333333333333, 1.0000000000000000;
  0.5000000000000000, 0.0000000000000000;
  0.5000000000000000, 0.1666666666666667;
  0.5000000000000000, 0.3333333333333333;
  0.5000000000000000, 0.5000000000000000;
  0.5000000000000000, 0.6666666666666666;
  0.5000000000000000, 0.8333333333333333;
  0.5000000000000000, 1.0000000000000000;
  0.6666666666666666, 0.0000000000000000;
  0.6666666666666666, 0.1666666666666667;
  0.6666666666666666, 0.3333333333333333;
  0.6666666666666666, 0.5000000000000000;
  0.6666666666666666, 0.6666666666666666;
  0.6666666666666666, 0.8333333333333333;
  0.6666666666666666, 1.0000000000000000;
  0.8333333333333333, 0.0000000000000000;
  0.8333333333333333, 0.1666666666666667;
  0.8333333333333333, 0.3333333333333333;
  0.8333333333333333, 0.5000000000000000;
  0.8333333333333333, 0.6666666666666666;
  0.8333333333333333, 0.8333333333333333;
  0.8333333333333333, 1.0000000000000000;
  1.0000000000000000, 0.0000000000000000;
  1.0000000000000000, 0.1666666666666667;
  1.0000000000000000, 0.3333333333333333;
  1.0000000000000000, 0.5000000000000000;
  1.0000000000000000, 0.6666666666666666;
  1.0000000000000000, 0.8333333333333333;
  1.0000000000000000, 1.0000000000000000;
];

icone = [
       1,      8,      9,      2;
       2,      9,     10,      3;
       3,     10,     11,      4;
       4,     11,     12,      5;
       5,     12,     13,      6;
       6,     13,     14,      7;
       8,     15,     16,      9;
       9,     16,     17,     10;
      10,     17,     18,     11;
      11,     18,     19,     12;
      12,     19,     20,     13;
      13,     20,     21,     14;
      15,     22,     23,     16;
      16,     23,     24,     17;
      17,     24,     25,     18;
      18,     25,     26,     19;
      19,     26,     27,     20;
      20,     27,     28,     21;
      22,     29,     30,     23;
      23,     30,     31,     24;
      24,     31,     32,     25;
      25,     32,     33,     26;
      26,     33,     34,     27;
      27,     34,     35,     28;
      29,     36,     37,     30;
      30,     37,     38,     31;
      31,     38,     39,     32;
      32,     39,     40,     33;
      33,     40,     41,     34;
      34,     41,     42,     35;
      36,     43,     44,     37;
      37,     44,     45,     38;
      38,     45,     46,     39;
      39,     46,     47,     40;
      40,     47,     48,     41;
      41,     48,     49,     42;
];

DIR = [
       1, 20.0000000000000000;
       2, 20.0000000000000000;
       3, 20.0000000000000000;
       4, 20.0000000000000000;
       5, 20.0000000000000000;
       6, 20.0000000000000000;
       7, 20.0000000000000000;
];

NEU = [
       1, 20.0000000000000000, 1;
       7, 20.0000000000000000, 3;
       8, 20.0000000000000000, 1;
      14, 20.0000000000000000, 3;
      15, 20.0000000000000000, 1;
      21, 20.0000000000000000, 3;
      22, 20.0000000000000000, 1;
      28, 20.0000000000000000, 3;
      29, 20.0000000000000000, 1;
      35, 20.0000000000000000, 3;
      36, 20.0000000000000000, 1;
      42, 20.0000000000000000, 3;
      43, 20.0000000000000000, 1;
      43, 20.0000000000000000, 2;
      44, 20.0000000000000000, 2;
      45, 20.0000000000000000, 2;
      46, 20.0000000000000000, 2;
      47, 20.0000000000000000, 2;
      48, 20.0000000000000000, 2;
      49, 20.0000000000000000, 2;
      49, 20.0000000000000000, 3;
];

ROB = [
];

disp('---------------------------------------------------------------');
disp('Inicializando modelo de datos...');

model.nnodes = size(xnode,1);

model.k = [
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
];

model.c = [
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
];

model.G = [
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
    1.0000000000000000;
];

% Esquema Temporal: [0] Explícito, [1] Implícito, [X] Estacionario
model.ts = 2;

% Parámetros para esquemas temporales
model.rho = 1.0000000000000000;
model.cp = 1.0000000000000000;
model.maxit =            1;
model.tol = 1.000000e-05;

% Condición inicial
model.PHI_n = mean(DIR(:,2))*ones(model.nnodes,1);

disp('Iniciando el método numérico...');

% Llamada principal al Método de Diferencias Finitas
[PHI,Q] = fdm2d(xnode, icone, DIR, NEU, ROB, model);

disp('Finalizada la ejecución del método numérico.');

disp('---------------------------------------------------------------');
disp('Iniciando el post-procesamiento...');

% mode ---> modo de visualización:
%           [0] 2D - Con malla
%           [1] 3D - Con malla
%           [2] 2D - Sin malla
%           [3] 3D - Sin malla
% graph --> tipo de gráfica:
%           [0] Temperatura (escalar)
%           [1] Flujo de Calor (vectorial)
%           [2] Flujo de Calor eje-x (escalar)
%           [3] Flujo de Calor eje-y (escalar)
%           [4] Magnitud de Flujo de Calor (escalar)
mode = 0;
graph = 0;
fdm2d_graph_mesh(full(PHI),Q,xnode,icone,mode,graph);

disp('Finalizado el post-procesamiento.');
